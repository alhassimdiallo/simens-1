<!-- Mes CSS -->
<?php echo $this->headLink()->appendStylesheet($this->basePath().'/css/consultation/styleMajConsultation.css');?>

<!-- MES JS -->
<?php echo $this->headLink()->appendStylesheet($this->basePath().'/js/consultation/jsMajConsultation.js');?>
<?php echo $this->headScript()->appendFile($this->basePath().'/js/mesjs/accordeon_controle_validation.js');?>

<?php
    function nbJours($debut, $fin) {
        //60 secondes X 60 minutes X 24 heures dans une journ�e
        $nbSecondes= 60*60*24;

        $debut_ts = strtotime($debut);
        $fin_ts = strtotime($fin);
        $diff = $fin_ts - $debut_ts;
        return round($diff / $nbSecondes);
    }
  ?>
<script>
$(function(){

<?php for($i=2 ; $i<=$this->nbMotifs; $i++){
         if($i == 2){?>
        	 $( "#motif2" ).toggle(true);
        	 $('#plus').children().remove();
      		 $('<span id="moins_3" > <a><img style="display: inline; float:left; border:transparent; padding-left:10px;" src="<?php echo $this->basePath().'/images_icons/moins-vert.PNG'?>" alt="Constantes" title="Supprimer" /></a></span>').appendTo("#plus");
      		 $('<span id="leschamps_3" > <a><img style="display: inline; float:left; border:transparent; padding-left:10px;" src="<?php echo $this->basePath().'/images_icons/add.PNG'?>" alt="Constantes" title="Ajouter" /></a></span>').appendTo("#moins_3");

       		 champ3();
        	 $( "#moins_3" ).click(function(){
        		 supChamp2();
        	 });
   <?php }
         if($i == 3){?>
        	 $( "#motif3" ).toggle(true);
        	 $('#plus').children().remove();
			 $('<span id="moins_4" > <a><img style="display: inline; float:left; border:transparent; padding-left:10px;" src="<?php echo $this->basePath().'/images_icons/moins-vert.PNG'?>" alt="Constantes" title="Supprimer" /></a></span>').appendTo("#plus");
			 $('<span id="leschamps_4" > <a><img style="display: inline; float:left; border:transparent; padding-left:10px;" src="<?php echo $this->basePath().'/images_icons/add.PNG'?>" alt="Constantes" title="Ajouter" /></a></span>').appendTo("#moins_4");

			 champ4();
			 $( "#moins_4" ).click(function(){
			     supChamp3();
			 });
   <?php }
         if($i == 4){?>
            $( "#motif4" ).toggle(true);
			$('#plus').children().remove();
			$('<span id="moins_5" > <a><img style="display: inline; float:left; border:transparent; padding-left:10px;" src="<?php echo $this->basePath().'/images_icons/moins-vert.PNG'?>" alt="Constantes" title="Supprimer" /></a></span>').appendTo("#plus");
			$('<span id="leschamps_5" > <a><img style="display: inline; float:left; border:transparent; padding-left:10px;" src="<?php echo $this->basePath().'/images_icons/add.PNG'?>" alt="Constantes" title="Ajouter" /></a></span>').appendTo("#moins_5");

			champ5();
			$( "#moins_5" ).click(function(){
			    supChamp4();
			});
	<?php }
	      if($i == 5){?>
	         $( "#motif5" ).toggle(true);
			 $('#plus').children().remove();
			 $('<span id="moins_6" > <a><img style="display: inline; float:left; border:transparent; padding-left:10px;" src="<?php echo $this->basePath().'/images_icons/moins-vert.PNG'?>" alt="Constantes" title="Supprimer" /></a></span>').prependTo("#plus");
			 supChamp5();
    <?php }?>

<?php } ?>
});
</script>



<?php use Facturation\View\Helper\DateHelper;
use Zend\Stdlib\DateTime;
$Control = new DateHelper();?>
<?php
$form = $this->form;
$form->setAttribute('action', $this->url('consultation', array('action' => 'maj-cons-donnees')));
$form->prepare();
echo $this->form()->openTag($form); ?>

<div id="accordions">  <!-- couleur bleu du logo//#49afcd-->

  <!--Accordeon ETAT CIVIL-->
    <div style='width:160px; font-family: police2;font-size: 17px; font-weight: bold;'>Etat Civil</div>
      <div style=' max-height: 345px;'>

         <img id="faces" src='<?php echo $this->basePath().'/img/photos_patients/'.$this->image;?>'  alt="Jonathan Verrecchia" style='float:left; margin-right:40px; width:105px; height:105px;'/>


       <p style='color: white; opacity: 0.09;'>
         <img id="faces" src='<?php echo $this->basePath().'/img/photos_patients/'.$this->image;?>'  alt="Jonathan Verrecchia" style='float:right; margin-right:15px; width:95px; height:95px;'/>
        </p>
         <table>
             <tr>
			   	<td style='width:160px; font-family: police1; font-size: 12px; color: green;'>
			   		<div id="aa"><a style="text-decoration: underline;">Civilit&eacute;</a><br><p style='font-weight: bold;font-size: 17px;'><?php echo $this->lesdetails->civilite;?></p></div>
			   	</td>

			   	<td style='width:160px; font-family: police1; font-size: 12px; color: green;'>
			   		<div id="aa"><a style="text-decoration: underline;">Lieu de naissance</a><br><p style='font-weight: bold;font-size: 17px;'><?php echo $this->lesdetails->lieu_naissance;?></p></div>
			   	</td>

			    <td style='width:160px; font-family: police1; font-size: 12px; color: green;'>
			   		<div id="aa"><a style="text-decoration: underline;">T&eacute;l&eacute;phone</a><br><p style='font-weight: bold;font-size: 17px;'><?php echo $this->lesdetails->telephone;?></p></div>
			   	</td>

			 </tr>

			 <tr>
			    <td style=' font-family: police1;font-size: 12px; color: green;'>
			   		<div id="aa"><a style="text-decoration: underline;">Pr&eacute;nom</a><br><p style='font-weight: bold;font-size: 19px;'><?php echo $this->lesdetails->prenom;?></p></div>
			   	</td>

			   	<td style=' font-family: police1;font-size: 12px; color: green;'>
			   		<div id="aa"><a style="text-decoration: underline;">Nationalit&eacute; origine</a><br><p style='font-weight: bold;font-size: 19px;'><?php echo $this->lesdetails->nationalite_origine;?></p></div>
			   	</td>

			   	<td style=' font-family: police1;font-size: 12px; color: green;'>
			   		<div id="aa"><a style="text-decoration: underline;">Email</a><br><p style='font-weight: bold;font-size: 19px;'><?php echo $this->lesdetails->email;?></p></div>
			   	</td>

			 </tr>

			 <tr>
			    <td style=' font-family: police1;font-size: 12px; color: green;'>
			   		<div id="aa"><a style="text-decoration: underline;">Nom</a><br><p style='font-weight: bold;font-size: 19px;'><?php echo $this->lesdetails->nom;?></p></div>
			   	</td>

			    <td style=' font-family: police1;font-size: 12px; color: green;'>
			   		<div id="aa"><a style="text-decoration: underline;">Nationalit&eacute; actuelle</a><br><p style='font-weight: bold;font-size: 19px;'><?php echo $this->lesdetails->nationalite_actuelle;?></p></div>
			   	</td>

			   	<td style=' font-family: police1;font-size: 12px; color: green;'>
			   		<div id="aa"><a style="text-decoration: underline;">Profession</a><br><p style='font-weight: bold;font-size: 19px;'><?php echo $this->lesdetails->profession;?></p></div>
			   	</td>

			 </tr>

			  <tr>
			   	<td style=' font-family: police1;font-size: 12px; color: green;'>
			   		<div id="aa"><a style="text-decoration: underline;">Date de naissance</a><br><p style='font-weight: bold;font-size: 19px;'><?php echo $Control->convertDate($this->lesdetails->date_naissance);?></p></div>
			   	</td>

			    <td style='width:195px; font-family: police1;font-size: 12px; color: green;'>
			   		<div id="aa"><a style="text-decoration: underline;">Adresse</a><br><p style='font-weight: bold;font-size: 19px;'><?php echo $this->lesdetails->adresse;?></p></div>
			   	</td>

			   	<td>
			   	</td>
			   	<?php

			   	if($this->verifieRV != false) {
			   	$dateRV = $this->verifieRV->date; $today = new \DateTime(); $date_actu = $today->format('Y-m-d');
                      $date = 'dans '.nbJours($date_actu,$dateRV).' jours';
                      if($dateRV == $today->format('Y-m-d')){
                         $date = "Ajourd'hui";
                      }else if(nbJours($date_actu,$dateRV) < 0){$date = 'd&eacute;pass&eacute;';}
                ?>
			   	<td>
			   	   <a>
				     <?php  echo ($this->verifieRV)? "<span id='image-neon' style='font-weight: bold; font-style: italic; font-size: 12px; color: red;'> Rendez-vous ".$date."</span>":""; ?>
				   </a>
				</td>
                <?php }?>
			  </tr>

         </table>
              <script>
			   	function FaireClignoterImage (){
                         $("#image-neon").fadeOut(900).delay(300).fadeIn(800);
                }
                $(document).ready(function(){
                     setInterval('FaireClignoterImage()',2200);
                });
              </script>
           <div id="barre"></div>
	       <div style='color: white; opacity: 1; width:95px; height:40px; float:right'>
             <img  src='<?php echo $this->basePath().'/images_icons/fleur1.jpg'?>'  alt="fleur1" />
          </div>
          <table id="numero" style=" padding-top:5px; width: 400px;">
           <tr>
             <td style="padding-top:5px; width: 70px; font-size: 12px;"> Consultation: </td>
             <td style="font-weight: bold;"> <?php echo $this->id_cons;?></td>
             <td style="font-weight: bold; width:10px;">|</td>
             <td style="padding-top:5px; width: 30px; font-size: 12px; "> Heure: </td>
             <td style="font-weight: bold;"> <?php echo $this->heure_cons;?></td>
           </tr>
          </table>
      </div>

   <!--Accordeon NOUVELLES CONSTANTES-->

     <div style='font-family: police2;font-size: 17px; font-weight: bold;'>Motifs d'admission et Constantes</div>
        <div style='min-height: 460px;'>

           <?php echo $this->formHidden($form->get('id_patient'));?>
           <?php echo $this->formHidden($form->get('id_medecin'));?>

           <!-- div style=" height: 310px; width: 1030px; text-align: justify; border: 0px solid black; overflow: auto;"-->

     <!-- **************************************************************************************************************** -->
           <!-- SOUS ACCORDEON MOTIF D'ADMISSION ET CONSTANTES -->
           <div id="accordionss">
        <!--**************** LES MOTIFS D ADMISSIONS ************************-->
              <div style='font-family: police2;font-size: 17px; font-weight: bold;'> Motifs d'admission </div>
               <div>
                <div style='width: 100%; height: 30px;'>
                 <div style='width: 70%; float: left; '>
                  <table id="responde" style='width: 100%;'>
                     <tr class="form-author" >
                         <th><?php echo $this->formRow($form->get('motif_admission1'));?></th>
                     </tr>
                     <tr class="form-author" id="motif2">
                         <th><?php echo $this->formRow($form->get('motif_admission2'));?></th>
                     </tr>
                     <tr class="form-author" id="motif3">
                         <th><?php echo $this->formRow($form->get('motif_admission3'));?></th>
                     </tr>
                     <tr class="form-author" id="motif4">
                         <th><?php echo $this->formRow($form->get('motif_admission4'));?></th>
                     </tr>
                     <tr class="form-author" id="motif5">
                         <th><?php echo $this->formRow($form->get('motif_admission5'));?></th>
                     </tr>

                     <tr>
                         <th id="plus">
                         <span id="moins_2" ></span>
                         <span id="leschamps_2" > <a><img style="display: inline; float:left; border:transparent; padding-left:10px;" src='<?php echo $this->basePath().'/images_icons/add.PNG'?>' alt="Constantes" title="Ajouter" /></a></span>
                         </th>
                     </tr>
                     <tr>
                         <th style="height:20px; margin-top: 5px; margin-right: 30px; float:right;">
                             <!-- On cr�e le bouton Valider (permettant la validation des donn�es -->
                             <div id="bouton_valider_motif">
                                  <button id='bouton_motif_valider'>Valider</button>
                             </div>
                             <!-- On cr�e le bouton MODIFIER (permettant la modification des donn�es -->
                             <div id="bouton_modifier_motif">
                                  <button id='bouton_motif_modifier'>Modifier</button>
                             </div>
                         </th>
                     </tr>

                  </table>
                 </div>
                
                <div style='width: 27%; float: left;'>
                  <p style='color: white; opacity: 0.5;'>
                     <img id="faces" src='<?php echo $this->basePath().'/images_icons/consult-motif.jpg'?>'  alt="consult-motif" style='margin-right:5px; height:315px;'/>
                  </p>
                </div>
              </div>
                
               </div>
          <!--**************** LES CONSTANTES ************************-->

              <div style='font-family: police2;font-size: 17px; font-weight: bold;'> Constantes </div>
                <div>
                 <table  id="respond" style='width: 100%;'>

                    <tr class="comment-form-author">
                        <td><?php echo $this->formRow($form->get('id_cons'));?></td>
                     	<td><?php echo $this->formRow($form->get('tension'));?></td>
                    	<td><?php echo $this->formRow($form->get('taille'));?></td>
                    	<td><?php echo $this->formRow($form->get('bu'));?></td>
                    </tr>

                       <!-- GESTION DES ERREURS -->
                       <tr>
                           <td></td>
                           <td> <div id="erreur_tension"></div> </td>
                           <td> <div id="erreur_taille"></div> </td>
                           <td> <div id="erreur_bu"></div> </td>
                       </tr>

                    <tr class="comment-form-author">
                        <td><?php echo $this->formRow($form->get('date_cons'));?></td>
                        <td><?php echo $this->formRow($form->get('poids'));?></td>
                        <td><?php echo $this->formRow($form->get('temperature'));?></td>
                        <td><?php echo $this->formRow($form->get('glycemie_capillaire'));?></td>
                    </tr>

                        <!-- GESTION DES ERREURS -->
                       <tr>
                           <td></td>
                           <td> <div id="erreur_poids"></div> </td>
                           <td> <div id="erreur_temperature"></div> </td>
                           <td> <div id="erreur_glycemie"></div> </td>
                       </tr>

                    <tr class="comment-form-author">
                        <td><?php echo $this->formRow($form->get('pouls'));?></td>
                        <td><?php echo $this->formRow($form->get('frequence_respiratoire'));?></td>
                    </tr>

                        <!-- GESTION DES ERREURS -->
                       <tr>
                           <td> <div id="erreur_pouls"></div> </td>
                           <td> <div id="erreur_frequence"></div> </td>
                           <td></td>
                           <td></td>
                       </tr>

                    <tr class="comment-form-author" style="height: 10px;">
                        <td></td>
                        <td></td>
                        <th > </th>
                        <th style="float:right; height:10px; padding-top: 35px;">
                           <!-- On cr�e le bouton Valider (permettant la validation des donn�es -->
                             <div id="bouton_valider_consantes">
                                  <button id='bouton_constantes_valider'>Valider</button>
                             </div>
                             <!-- On cr�e le bouton MODIFIER (permettant la modification des donn�es -->
                             <div id="bouton_modifier_constantes">
                                  <button id='bouton_constantes_modifier'>Modifier</button>
                             </div>
                        </th>
                    </tr>
                 </table>
                </div>
            </div>
     <!-- **************************************************************************************************************** -->

     </div>
</div>

     <table>
         <tr>
           <td style="background-color:#eeeeee;">
              <div> <button type="submit" name="terminer" id="terminer" style=" margin-left:400px; margin-top: 20px; font-family: police2;font-size: 18px; font-weight: bold;"> Terminer </button> </div>
           </td>
           <td style="background-color:#eeeeee;">
              <div> <button type="submit" id="annuler" style=" margin-right:340px; margin-top: 20px; font-family: police2;font-size: 18px; font-weight: bold;"> Annuler </button> </div>
           </td>
         </tr>
       </table>
                       <!-- POP UP pour Confirmation Annulation -->
                            <div id="confirmation" title="Confirmation de la suppression" style="display:none;">
                              <p style="font-size: 16px;">
                                 <span style="float:left; margin:0 0px 20px 0; ">
                                 <img src="<?php echo $this->basePath().'/images_icons/warning_16.png';?>" />

                                 Etes-vous s&ucirc;r de vouloir annuler les modifications ?</span>
                              </p>
                            </div>

<?php echo $this->form()->closeTag();?>
<script>
//POUR LE MENU GAUCHE dans -elementgauche.phtml
$('#plus_naissance').toggle(true);
$("#naissance").replaceWith("<li id='naissance' style='background:#4a5765;'><a href=''><span style='margin-left:0px; color: #ffffff; font-weight:bold; font-size:18px; font-family:Times New Roman;'> <img style='display: inline;' src='<?php echo $this->basePath().'/images_icons/moins-vert.PNG'?>' alt='Liste' /> Surveillant de service </span></a></li>");
dep1();
$('#ajouter_style').css({'font-weight':'bold','color':'white','font-size':'22px'});
</script>